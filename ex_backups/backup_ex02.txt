nrows = 0
    ! the numbers of rows and column must be equal and greater than 1
    do while (nrows .ne. ncols) 
        print *, "Please enter the dimension of the matrix [nrows, ncols]:"
        read (*, *) nrows, ncols
        do while (nrows .le. 1)
            print *, "Non valid dimension!"
            print *, "Please enter the dimension of the matrix [nrows, ncols]:"
            read (*, *) nrows, ncols 
            if (nrows .le. 1) then 
                print *, "Invalid number of rows!"
            end if 
            if (ncols .le. 1) then 
                print *, "Invalid number of columns!"
            end if 
            if (nrows .ne. ncols) then 
                print *, "The matrix must be square!"
            end if 
        end do
    end do 


-------------------------------
-------------------------------


print *, "Please enter the dimension of the matrix [nrows, ncols]:"
    read (*, *) nrows, ncols
    if (nrows .ne. ncols) then 
        print *, "Warining! The matrix is not square, so the trace is not defined and will be set to zero. &
                 &Do you want to continue? [y/n]" 
        read *, answ 
        if (answ == "y") then 
            do while ((nrows .le. 1) .or. (ncols .le. 1))
                print *, "Non valid dimension!"
                print *, "Please enter the dimension of the matrix [nrows, ncols]:"
                read (*, *) nrows, ncols  
            end do
        end if 
        if (answ == "n") then 
            do while (nrows .ne. ncols) 
                print *, "Please enter the dimension of the matrix [nrows, ncols]:"
                read (*, *) nrows, ncols
                do while (nrows .le. 1)
                    print *, "Non valid dimension!"
                    print *, "Please enter the dimension of the matrix [nrows, ncols]:"
                    read (*, *) nrows, ncols 
                    if (nrows .le. 1) then 
                        print *, "Invalid number of rows!"
                    end if 
                    if (ncols .le. 1) then 
                        print *, "Invalid number of columns!"
                    end if 
                    if (nrows .ne. ncols) then 
                        print *, "The matrix must be square!"
                    end if 
                end do
            end do 
    end if


----------------------


do while ((nrows .le. 1) .or. (ncols .le. 1))
        print *, "Non valid dimension!"
        print *, "Please enter the dimension of the matrix [nrows, ncols]:"
        read (*, *) nrows, ncols
    end do
    
    if (nrows .ne. ncols) then 
        print *, "Warining! The matrix is not square, so the trace is not defined and will be set to zero."
        print *, "Do you want to continue? [y/n]" 
        read *, answ 
        if (answ == "y") then 
            continue
        else if (answ == "n") then 
            do while (nrows .ne. ncols) 
                print *, "Please enter the dimension of a square matrix [nrows, ncols]:"
                read (*, *) nrows, ncols
                if (nrows .ne. ncols) then 
                    print *, "The matrix is not square."
                end if 
            end do
        else
            print *, "Non valid answer. The program will stop."
            stop 
        end if 
    end if 